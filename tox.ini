[tox]
envlist = py36, py37, lint
skipsdist = True
skip_missing_interpreters = true

[testenv]
deps = -rrequirements.txt
commands = pytest

[testenv:lint]
deps = -rrequirements.txt
commands = flake8 changes tests setup.py

[pytest]
addopts = -vv --durations=10 --failed-first --cov changes --cov-report term-missing tests

[flake8]
ignore = E501

[testenv:fix_lint]
description = format the code base to adhere to our styles, and complain about what we cannot do automatically
basepython = python3.7
extras = lint
deps = pre-commit == 1.10.3
skip_install = True
commands = pre-commit run --all-files --show-diff-on-failure
           python -c 'import pathlib; print("hint: run \{\} install to add checks as pre-commit hook".format(pathlib.Path(r"{envdir}") / "bin" / "pre-commit"))'
